CREATE SCHEMA sql_proyect;
USE sql_proyect;

CREATE TABLE ESTUDIANTES(
	DNI VARCHAR(10) UNIQUE NOT NULL,
    NOMBRE VARCHAR(25) NOT NULL,
    TELEFONO VARCHAR(9),
    CONSTRAINT PK_ESTUDIANTES_DNI PRIMARY KEY (DNI)
);

CREATE TABLE PROFESORES(
	DNI VARCHAR(10) UNIQUE NOT NULL,
    NOMBRE VARCHAR(25) NOT NULL,
    TELEFONO VARCHAR(9),
    MATERIA VARCHAR(25) UNIQUE NOT NULL,
    CONSTRAINT PK_PROFESORES_DNI PRIMARY KEY (DNI)
);

CREATE TABLE CURSOS(
    NOMBRE VARCHAR(25) UNIQUE NOT NULL,
	PROFESOR_DNI VARCHAR(10) NOT NULL,
    CONSTRAINT PK_CURSOS_NOMBRE PRIMARY KEY (NOMBRE),
    CONSTRAINT FK_CURSOS_PROFESORES FOREIGN KEY (PROFESOR_DNI) REFERENCES PROFESORES(DNI)
);

CREATE TABLE CALIFICACIONES(
    NOTA FLOAT,
	PROFESOR_DNI VARCHAR(10) NOT NULL,
    ESTUDIANTE_DNI VARCHAR(10) NOT NULL,
    CURSO_NOMBRE VARCHAR(25) NOT NULL,
    CONSTRAINT PK_CALIFICACIONES PRIMARY KEY (PROFESOR_DNI, ESTUDIANTE_DNI, CURSO_NOMBRE),
    CONSTRAINT FK_CALIFICACIONES_CURSOS FOREIGN KEY (CURSO_NOMBRE) REFERENCES CURSOS(NOMBRE),
    CONSTRAINT FK_CALIFICACIONES_PROFESORES FOREIGN KEY (PROFESOR_DNI) REFERENCES PROFESORES(DNI),
    CONSTRAINT FK_CALIFICACIONES_ESTUDIANTES FOREIGN KEY (ESTUDIANTE_DNI) REFERENCES ESTUDIANTES(DNI)
);

INSERT INTO ESTUDIANTES (NOMBRE, DNI, TELEFONO) VALUES 
	('Laura', '74723695D', '669458969'),
    ('Luis', '45897571F', '945632789'),
    ('Antonia', '12636645C', '666666749'),
    ('Ruben', '00024485D', '666385547'),
    ('Manuela', '44874755K', '665398123'),
    ('Marcos', '75964825J', '654852395'),
    ('Maria', '12354678H', '852694735'),
    ('Juan Alberto', '12345678H', '123456789');


INSERT INTO PROFESORES (NOMBRE, DNI, TELEFONO, MATERIA) VALUES 
	('Margarita', '74523695D', '666458969', 'Matematicas'),
    ('Antonio', '02636645C', '666666589', 'Euskera'),
    ('Lola', '00024485L', '669785547', 'Castellano'),
    ('Sara', '44877755K', '665321123', 'Ingles');
    
INSERT INTO CURSOS (NOMBRE, PROFESOR_DNI) VALUES 
	('Matematicas', '74523695D'),
    ('Euskera', '02636645C'),
    ('Castellano', '00024485L'),
    ('Ingles', '44877755K');

INSERT INTO CALIFICACIONES (NOTA, PROFESOR_DNI, ESTUDIANTE_DNI, CURSO_NOMBRE)
SELECT 
    RAND() * 10 AS NOTA,
    P.DNI AS PROFESOR_DNI,
    E.DNI AS ESTUDIANTE_DNI,
    C.NOMBRE AS CURSO_NOMBRE
FROM PROFESORES P
CROSS JOIN ESTUDIANTES E
CROSS JOIN CURSOS C;

COMMIT; 






